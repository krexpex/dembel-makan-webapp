@tailwind base;
@tailwind components;
@tailwind utilities;

/* ====== ОСНОВЫ / БАЗА ====== */
html, body {
  @apply bg-black text-white select-none overflow-x-hidden;
  font-family: 'Inter', 'SF Pro Display', system-ui, sans-serif;
  -webkit-tap-highlight-color: transparent;
}
*, *::before, *::after { box-sizing: border-box; }
button { @apply focus:outline-none; }

/* Безопасная зона снизу (iOS home indicator) — пригодится в контейнерах */
.safe-bottom {
  padding-bottom: calc(16px + env(safe-area-inset-bottom, 0px));
}

/* ====== СЛОИ СЦЕНЫ ====== */
.makan-layer { position: relative; z-index: 10; } /* Макан поверх PNG-надписей */
.jeb-layer   { position: relative; z-index: 6; }  /* PNG-надписи над фоном/кольцом */
.jeb-img { image-rendering: -webkit-optimize-contrast; filter: drop-shadow(0 6px 18px rgba(0,0,0,.25)); }

/* ====== ОБЩИЕ АНИМАЦИИ ВХОДА ====== */
.appear-scale { animation: appear-scale .6s cubic-bezier(.25,1,.5,1); }
@keyframes appear-scale { 0%{transform:scale(.85);opacity:0}100%{transform:scale(1);opacity:1} }

.appear-fade-up { animation: appear-fade-up .6s cubic-bezier(.25,1,.5,1); }
@keyframes appear-fade-up { 0%{transform:translateY(10px);opacity:0}100%{transform:translateY(0);opacity:1} }

.glow-enter { animation: glow-enter 2s ease-out forwards; }
@keyframes glow-enter { 0%{opacity:0;transform:scale(1.3)}100%{opacity:1;transform:scale(1)} }

/* ====== PNG НАДПИСИ (3/7/10 тапов) ====== */
.jeb-layer { animation: fadein .4s ease-out forwards; }
.auto-fade-out { animation: fadeout 2.4s ease-out forwards; }
@keyframes fadein { from{opacity:0} to{opacity:1} }
@keyframes fadeout { 0%,90%{opacity:1} 100%{opacity:0} }

.animate-rise-left { animation: rise-left 2.2s cubic-bezier(.25,1,.3,1) forwards; }
@keyframes rise-left {
  0%{opacity:0;transform:translateY(20px) rotate(-4deg)}
  15%{opacity:1;transform:translateY(0) rotate(0)}
  85%{opacity:1;transform:translateY(-4px)}
  100%{opacity:0;transform:translateY(-10px)}
}

.animate-slide-from-right { animation: slide-right 2.2s cubic-bezier(.25,1,.3,1) forwards; }
@keyframes slide-right {
  0%{opacity:0;transform:translateX(40px) rotate(2deg)}
  15%{opacity:1;transform:translateX(0) rotate(0)}
  85%{opacity:1}
  100%{opacity:0;transform:translateX(20px)}
}

/* ====== МАКАН (покачивание + тень) ====== */
.makan-shadow { filter: drop-shadow(0 10px 20px rgba(0,0,0,.6)); }
.animate-wobble { animation: wobble 2.4s ease-in-out infinite; }
@keyframes wobble { 0%,100%{transform:rotate(0)} 50%{transform:rotate(.4deg)} }

/* ====== БУРГЕР / МЕНЮ ====== */
.glass-btn{
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 4px 18px rgba(0,0,0,.45);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  transition: background .25s, transform .25s;
}
.glass-btn:active{ background: rgba(255,255,255,.12); transform: scale(.96); }
.glass-menu{
  background: rgba(18,18,18,.85);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 10px 28px rgba(0,0,0,.4);
  border-radius: 16px;
}

/* =========================================================
   LIQUID ISLAND (компактный, иконки одинаково видны в статике/динамике)
   ========================================================= */
.island{
  position: relative;
  filter: url(#goo);
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 12px 40px rgba(0,0,0,.28);
  backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
  pointer-events: none;
  border-radius: 34px;
}
/* внутренняя тёмная вуаль — ключ к читаемости иконок без движения */
.island::after{
  content:""; position:absolute; inset:4px;
  border-radius: 30px;
  background: linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,.18));
  z-index: 0; pointer-events: none;
}
.island-compact{ width: min(420px, 76vw); }
.not-full{ margin: 0 auto; }

/* Ряд кнопок — компактные интервалы */
.island-row{
  position: relative; height: 100%;
  display: flex; align-items: center; justify-content: center;
  gap: 12px; pointer-events: none;
}

/* Кнопки — ВСЕГДА видимы (и соседние тоже), выше пузырька/капли */
.island-btn{
  height: 56px; width: 56px;
  display: grid; place-items: center;
  color: #e8f3ff;                 /* ярче, чем #eef2f6 */
  z-index: 3;                     /* выше пузырька и капли */
  border-radius: 22px;
  transition: color .2s ease, transform .12s ease, opacity .2s ease;
  opacity: .95;                   /* заметнее в статике */
  pointer-events: auto;
  position: relative;
}
.island-btn svg{
  width: 26px; height: 26px;
  filter: drop-shadow(0 0 6px rgba(0,0,0,.35)); /* читается на любом фоне */
}
.island-btn:active { transform: scale(.96); }
.island-btn:not(.active){ opacity: .92; }       /* соседние не «глушим» */

/* Мягкая плашка под иконкой — присутствует всегда */
.island-btn::before{
  content:""; position:absolute; inset:0; margin:auto;
  width:46px; height:46px; border-radius:23px;
  background: rgba(255,255,255,.08);
  box-shadow: inset 0 1px 1px rgba(255,255,255,.08),
              0 6px 12px rgba(0,0,0,.18);
  z-index:-1; transition: background .2s ease, transform .2s ease;
}
.island-btn.active::before{ background: rgba(255,255,255,.14); transform: scale(1.05); }

/* ПУЗЫРЁК вокруг активной иконки — статичный маркер, перетекает при смене */
.active-bubble{
  position:absolute; top:50%; left:0;
  height:58px; width:var(--w,58px);
  transform: translateX(calc(var(--x,0px) - 50%)) translateY(-50%);
  z-index:2; pointer-events:none;
  transition: transform 380ms cubic-bezier(.22,.76,.25,1),
              width 380ms cubic-bezier(.22,.76,.25,1);
  border-radius:29px;
}
.bubble-mounted{ transition-delay: 10ms; }
.active-bubble-core{
  position:absolute; inset:0; border-radius:29px;
  background: radial-gradient(140% 120% at 50% 7%,
              rgba(255,255,255,.38), rgba(255,255,255,.12) 42%, rgba(255,255,255,.07) 100%);
  border: 1px solid rgba(255,255,255,.32);
  box-shadow:
    inset 0 1px 8px rgba(255,255,255,.32),
    inset 0 -14px 24px rgba(0,0,0,.30),
    0 12px 26px rgba(0,0,0,.30);
}
.active-bubble-gloss{
  position:absolute; inset:0; border-radius:29px; pointer-events:none; mix-blend-mode:screen; opacity:.7;
  background:
    radial-gradient(60% 36% at 50% 2%, rgba(255,255,255,.6), transparent 60%),
    radial-gradient(62% 56% at 50% 86%, rgba(0,0,0,.22), transparent 60%);
}

/* КАПЛЯ-перелив (динамика) — ниже кнопок */
.blob-real{
  position:absolute; top:50%; left:0;
  height:56px; width:var(--w,64px);
  border-radius:28px;
  transform: translateX(calc(var(--x,0px) - 50%)) translateY(-50%);
  transition: transform 420ms cubic-bezier(.23,.86,.2,1),
              width 420ms cubic-bezier(.23,.86,.2,1);
  z-index:1; pointer-events:none;
}
.blob-mounted{ transition-delay: 18ms; }
.stretch-r,.stretch-l{ transition-timing-function: cubic-bezier(.23,.86,.2,1); }
.blob-core{
  position:absolute; inset:0; border-radius:28px;
  background: radial-gradient(90% 120% at 50% 12%,
              rgba(255,255,255,.28), rgba(255,255,255,.12) 45%, rgba(255,255,255,.07) 100%);
  border: 1px solid rgba(255,255,255,.24);
  border-bottom-color: rgba(0,0,0,.2);
  box-shadow:
    inset 0 1px 6px rgba(255,255,255,.26),
    inset 0 -12px 22px rgba(0,0,0,.26),
    0 10px 24px rgba(0,0,0,.26);
}
.blob-spec{
  position:absolute; inset:0; border-radius:28px;
  background:
    radial-gradient(70% 40% at 50% 5%, rgba(255,255,255,.48), transparent 60%),
    radial-gradient(60% 60% at 50% 80%, rgba(0,0,0,.20), transparent 60%);
  mix-blend-mode: screen; opacity:.62;
}

/* ====== ДОП. ДИЗАЙН-ФИКСЫ (микро) ====== */
/* Чуть ярче грани у «стеклянных» элементов на ретина-дисплеях */
@media (min-resolution: 2dppx) {
  .glass-btn, .island {
    border-color: rgba(255,255,255,.16);
  }
}

/* Лёгкая пульсация активного пузырька — можно выключить, если мешает */
@keyframes bubble-breathe {
  0%,100% { transform: scale(1); }
  50% { transform: scale(1.015); }
}
.island-btn.active ~ .active-bubble .active-bubble-core {
  animation: bubble-breathe 3.6s ease-in-out infinite;
}

/* ====== ФОЛБЭК, ЕСЛИ НЕТ BLUR (старые Android WebView / низкая мощность) ====== */
@supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
  .island { background: rgba(25, 27, 29, .92); }
  .island::after { background: linear-gradient(180deg, rgba(0,0,0,.32), rgba(0,0,0,.24)); }
  .glass-btn { background: rgba(40,40,44,.9); }
  .glass-menu { background: rgba(22,22,24,.95); }
}
