@tailwind base;
@tailwind components;
@tailwind utilities;

/* ==========================
   БАЗА / ГЛОБАЛЬНОЕ
   ========================== */
html, body{
  @apply bg-black text-white select-none overflow-x-hidden;
  font-family: 'Inter','SF Pro Display',system-ui,sans-serif;
  -webkit-tap-highlight-color: transparent;
}
*,*::before,*::after{ box-sizing: border-box; }
button{ @apply focus:outline-none; }
.safe-bottom{ padding-bottom: calc(16px + env(safe-area-inset-bottom,0px)); }

/* ==========================
   СЛОИ СЦЕНЫ
   ========================== */
.makan-layer{ position:relative; z-index:10; } /* Макан всегда над PNG-надписями */
.jeb-layer{ position:relative; z-index:6; }    /* PNG-надписи над фоном/кольцом */
.jeb-img{ image-rendering:-webkit-optimize-contrast; filter:drop-shadow(0 6px 18px rgba(0,0,0,.25)); }

/* ==========================
   ОБЩИЕ АНИМАЦИИ ВХОДА
   ========================== */
.appear-scale{ animation:appear-scale .6s cubic-bezier(.25,1,.5,1); }
@keyframes appear-scale{ 0%{transform:scale(.85);opacity:0} 100%{transform:scale(1);opacity:1} }

.appear-fade-up{ animation:appear-fade-up .6s cubic-bezier(.25,1,.5,1); }
@keyframes appear-fade-up{ 0%{transform:translateY(10px);opacity:0} 100%{transform:translateY(0);opacity:1} }

.glow-enter{ animation:glow-enter 2s ease-out forwards; }
@keyframes glow-enter{ 0%{opacity:0;transform:scale(1.3)} 100%{opacity:1;transform:scale(1)} }

/* ==========================
   PNG-НАДПИСИ (3/7/10 тапов)
   ========================== */
.jeb-layer{ animation:fadein .4s ease-out forwards; }
.auto-fade-out{ animation:fadeout 2.4s ease-out forwards; }
@keyframes fadein{ from{opacity:0} to{opacity:1} }
@keyframes fadeout{ 0%,90%{opacity:1} 100%{opacity:0} }

.animate-rise-left{ animation:rise-left 2.2s cubic-bezier(.25,1,.3,1) forwards; }
@keyframes rise-left{
  0%{opacity:0;transform:translateY(20px) rotate(-4deg)}
  15%{opacity:1;transform:translateY(0) rotate(0)}
  85%{opacity:1;transform:translateY(-4px)}
  100%{opacity:0;transform:translateY(-10px)}
}
.animate-slide-from-right{ animation:slide-right 2.2s cubic-bezier(.25,1,.3,1) forwards; }
@keyframes slide-right{
  0%{opacity:0;transform:translateX(40px) rotate(2deg)}
  15%{opacity:1;transform:translateX(0) rotate(0)}
  85%{opacity:1}
  100%{opacity:0;transform:translateX(20px)}
}

/* ==========================
   МАКАН
   ========================== */
.makan-shadow{ filter:drop-shadow(0 10px 20px rgba(0,0,0,.6)); }
.animate-wobble{ animation:wobble 2.4s ease-in-out infinite; }
@keyframes wobble{ 0%,100%{transform:rotate(0)} 50%{transform:rotate(.4deg)} }

/* ==========================
   БУРГЕР / МЕНЮ
   ========================== */
.glass-btn{
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 4px 18px rgba(0,0,0,.45);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  transition: background .25s, transform .25s;
}
.glass-btn:active{ background:rgba(255,255,255,.12); transform:scale(.96); }

.glass-menu{
  background: rgba(18,18,18,.85);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 10px 28px rgba(0,0,0,.4);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  border-radius: 16px;
}

/* =========================================================
   LIQUID ISLAND — компактный «островок»
   Иконки видны ВСЕГДА (в статике и динамике)
   ========================================================= */
.island{
  position:relative;
  filter:url(#goo);
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  border:1px solid rgba(255,255,255,.14);
  box-shadow:0 12px 40px rgba(0,0,0,.28);
  backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
  pointer-events:none;
  border-radius:34px;
}
/* внутренняя тёмная вуаль — обеспечивает контраст иконок в статике */
.island::after{
  content:"";
  position:absolute; inset:4px;
  border-radius:30px;
  background: linear-gradient(180deg, rgba(0,0,0,.28), rgba(0,0,0,.18));
  z-index:0; pointer-events:none;
}
.island-compact{ width:min(420px,76vw); }
.not-full{ margin:0 auto; }

/* Ряд иконок */
.island-row{
  position:relative; height:100%;
  display:flex; align-items:center; justify-content:center;
  gap:12px; pointer-events:none;
}

/* Кнопки-иконки — ВСЕГДА видимы; поверх пузыря/капли */
.island-btn{
  height:56px; width:56px;
  display:grid; place-items:center;
  color:#f2f7ff;                        /* светлее для стабильной читаемости */
  z-index:3;                             /* выше пузырька и капли */
  border-radius:22px;
  transition: color .2s, transform .12s, opacity .2s;
  opacity:.98;                           /* заметно и в статике */
  pointer-events:auto;
  position:relative;
}
.island-btn svg{
  width:26px; height:26px;
  filter: drop-shadow(0 0 6px rgba(0,0,0,.35)); /* ореол, чтобы не терялся на фоне */
}
.island-btn:active{ transform:scale(.96); }

/* Плашка под КАЖДОЙ иконкой (всегда, без пузырька) */
.island-btn::before{
  content:""; position:absolute; inset:0; margin:auto;
  width:46px; height:46px; border-radius:23px;
  background: rgba(255,255,255,.10);            /* чуть ярче, чем раньше */
  box-shadow: inset 0 1px 1px rgba(255,255,255,.10),
              0 6px 12px rgba(0,0,0,.18);
  z-index:-1;
  transition: background .2s, transform .2s, box-shadow .2s;
}
/* Мягкий ореол — чтобы соседние тоже читались без пузыря */
.island-btn::after{
  content:""; position:absolute; inset:0; margin:auto;
  width:54px; height:54px; border-radius:27px;
  z-index:-2; pointer-events:none;
  background:
    radial-gradient(60% 60% at 50% 40%, rgba(255,255,255,.07), transparent 70%),
    radial-gradient(70% 70% at 50% 75%, rgba(0,0,0,.12), transparent 60%);
  opacity:.9;
}

/* Для активной — плашка ярче, ореол приглушим (роль акцента у пузыря) */
.island-btn.active::before{
  background: rgba(255,255,255,.16);
  transform: scale(1.06);
  box-shadow: inset 0 2px 4px rgba(255,255,255,.16),
              0 10px 16px rgba(0,0,0,.25);
}
.island-btn.active::after{ opacity:.25; }

/* ПУЗЫРЁК вокруг активной иконки (статичный маркер). */
.active-bubble{
  position:absolute; top:50%; left:0;
  height:58px; width:var(--w,58px);
  transform: translateX(calc(var(--x,0px) - 50%)) translateY(-50%);
  z-index:2; pointer-events:none;
  transition: transform 380ms cubic-bezier(.22,.76,.25,1),
              width 380ms cubic-bezier(.22,.76,.25,1);
  border-radius:29px;
}
.bubble-mounted{ transition-delay:10ms; }
.active-bubble-core{
  position:absolute; inset:0; border-radius:29px;
  background: radial-gradient(140% 120% at 50% 7%,
              rgba(255,255,255,.38), rgba(255,255,255,.12) 42%, rgba(255,255,255,.07) 100%);
  border:1px solid rgba(255,255,255,.32);
  box-shadow:
    inset 0 1px 8px rgba(255,255,255,.32),
    inset 0 -14px 24px rgba(0,0,0,.30),
    0 12px 26px rgba(0,0,0,.30);
}
.active-bubble-gloss{
  position:absolute; inset:0; border-radius:29px; pointer-events:none;
  mix-blend-mode:screen; opacity:.7;
  background:
    radial-gradient(60% 36% at 50% 2%, rgba(255,255,255,.6), transparent 60%),
    radial-gradient(62% 56% at 50% 86%, rgba(0,0,0,.22), transparent 60%);
}

/* КАПЛЯ-ПЕРЕЛИВ (динамическая), ниже кнопок */
.blob-real{
  position:absolute; top:50%; left:0;
  height:56px; width:var(--w,64px);
  border-radius:28px;
  transform: translateX(calc(var(--x,0px) - 50%)) translateY(-50%);
  transition: transform 420ms cubic-bezier(.23,.86,.2,1),
              width 420ms cubic-bezier(.23,.86,.2,1);
  z-index:1; pointer-events:none;
}
.blob-mounted{ transition-delay:18ms; }
.stretch-r,.stretch-l{ transition-timing-function:cubic-bezier(.23,.86,.2,1); }
.blob-core{
  position:absolute; inset:0; border-radius:28px;
  background: radial-gradient(90% 120% at 50% 12%,
              rgba(255,255,255,.28), rgba(255,255,255,.12) 45%, rgba(255,255,255,.07) 100%);
  border:1px solid rgba(255,255,255,.24);
  border-bottom-color:rgba(0,0,0,.2);
  box-shadow:
    inset 0 1px 6px rgba(255,255,255,.26),
    inset 0 -12px 22px rgba(0,0,0,.26),
    0 10px 24px rgba(0,0,0,.26);
}
.blob-spec{
  position:absolute; inset:0; border-radius:28px;
  background:
    radial-gradient(70% 40% at 50% 5%, rgba(255,255,255,.48), transparent 60%),
    radial-gradient(60% 60% at 50% 80%, rgba(0,0,0,.20), transparent 60%);
  mix-blend-mode:screen; opacity:.62;
}

/* Лёгкое «дыхание» активного пузыря (можно отключить) */
@keyframes bubble-breathe{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.015)} }
.island-btn.active ~ .active-bubble .active-bubble-core{ animation:bubble-breathe 3.6s ease-in-out infinite; }

/* ==========================
   ФОЛБЭК БЕЗ BLUR (старые WebView)
   ========================== */
@supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){
  .island{ background:rgba(25,27,29,.92); }
  .island::after{ background:linear-gradient(180deg, rgba(0,0,0,.32), rgba(0,0,0,.24)); }
  .glass-btn{ background:rgba(40,40,44,.9); }
  .glass-menu{ background:rgba(22,22,24,.95); }
}
